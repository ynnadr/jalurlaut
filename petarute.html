<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peta Rute Interaktif: Petualangan Nusantara</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        /* CSS tetap sama */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%); min-height: 100vh; padding: 10px; }
        h1 { text-align: center; margin-bottom: 20px; color: #00796b; font-size: 1.5rem; font-weight: 600; line-height: 1.2; }
        h1 br { display: block; margin: 0; }
        .intro { text-align: center; margin-bottom: 20px; font-size: 0.9rem; color: #555; }
        .back-link, .animate-btn { display: block; text-align: center; margin-bottom: 20px; padding: 10px; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); text-decoration: none; color: #00796b; font-weight: 500; transition: background 0.3s; border: none; cursor: pointer; }
        .animate-btn { background: linear-gradient(90deg, #00796b 0%, #004d40 100%); color: white; margin: 10px auto; width: 250px; font-size: 1rem; }
        .animate-btn:hover, .back-link:hover { background: #f0f8f0; }
        .animate-btn:hover { background: #004d40; }
        #map { height: 60vh; width: 100%; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .legend { background: white; padding: 15px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-top: 10px; }
        .legend h3 { color: #00796b; margin-bottom: 10px; font-size: 1.1rem; }
        .legend ul { list-style: none; padding: 0; }
        .legend li { margin-bottom: 8px; padding-left: 20px; position: relative; font-size: 0.9rem; }
        .legend li::before { content: '‚Ä¢'; position: absolute; left: 0; color: #00796b; font-size: 1.2rem; }
        footer { text-align: center; margin-top: 30px; padding: 15px; color: #666; font-size: 0.8rem; border-top: 1px solid #e0e0e0; }
        @media (min-width: 768px) {
            body { padding: 20px; max-width: 1200px; margin: 0 auto; }
            h1 { font-size: 2rem; }
            #map { height: 70vh; }
        }
    </style>
</head>
<body>
    <h1>Peta Rute Interaktif<br>Petualangan Nusantara</h1>
    <p class="intro">Zoom, pan, dan klik garis rute untuk detail waktu tempuh leg. Marker biru untuk titik utama. Klik tombol untuk animasi kapal!</p>
    
    <button id="animationBtn" class="animate-btn" onclick="toggleAnimation()">üö¢ Mulai Animasi Gerakan Kapal</button>
    
    <a href="index.html" class="back-link">‚Üê Kembali ke Timeline Perjalanan</a>

    <div id="map"></div>

    <div class="legend">
        <h3>Legenda Rute</h3>
        <ul>
            <li><strong>Marker Biru:</strong> Titik Keberangkatan/Tujuan (Klik untuk info segmen)</li>
            <li><strong>Garis Merah:</strong> Rute Laut Utama (Kapal Pelni/Perintis) - Klik untuk jam tempuh</li>
            <li><strong>Garis Hijau:</strong> Rute Darat Pendek (Bus/Ojek) - Klik untuk jam tempuh</li>
            <li><strong>üö¢ Kapal Animasi:</strong> Gerakan sepanjang rute saat tombol ditekan</li>
            <!-- === PERUBAHAN DI SINI === -->
            <li>Total Durasi Trip: **45 Hari**, 9 Segmen</li>
            <!-- ========================= -->
        </ul>
    </div>

    <footer>
        &copy; 2025 - ynnadr
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Data peta tetap sama
        const map = L.map('map').setView([-2.0, 110.0], 5);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
        const points = [
            { name: 'Jakarta', lat: -6.2088, lng: 106.8456, seg: '1. Start' },
            { name: 'Jemaja (Letung)', lat: 2.9642, lng: 105.7539, seg: '2. Jemaja' },
            { name: 'Tambelan', lat: 0.9755, lng: 107.5617, seg: '3. Tambelan' },
            { name: 'Pontianak', lat: 0, lng: 109.35, seg: '4. Pontianak' },
            { name: 'Pangkalan Bun', lat: -2.7, lng: 111.9, seg: '5. Pangkalan Bun' },
            { name: 'Banjarmasin', lat: -3.32, lng: 114.59, seg: '6. Banjarmasin' },
            { name: 'Balikpapan', lat: -1.26, lng: 116.83, seg: '7. Balikpapan' },
            { name: 'Parepare', lat: -3.97, lng: 119.62, seg: '8. Parepare' },
            { name: 'Makassar', lat: -5.14, lng: 119.41, seg: '9. Makassar' },
            { name: 'Jakarta (End)', lat: -6.2088, lng: 106.8456, seg: 'Pulang' }
        ];
        points.forEach(point => {
            L.marker([point.lat, point.lng], {
                icon: L.icon({
                    iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png',
                    shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
                    iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34], shadowSize: [41, 41]
                })
            }).addTo(map).bindPopup(`<b>${point.name}</b><br>Segmen: ${point.seg}`);
        });
        const legs = [
            { from: 0, to: 1, duration: '~44 jam', color: 'red' }, { from: 1, to: 2, duration: '~19 jam', color: 'red' },
            { from: 2, to: 3, duration: '~16 jam', color: 'red' }, { from: 3, to: 4, duration: '~40 jam', color: 'red' },
            { from: 4, to: 5, duration: '~12 jam', color: 'red' }, { from: 5, to: 6, duration: '~8 jam', color: 'red' },
            { from: 6, to: 7, duration: '~12 jam', color: 'red' }, { from: 7, to: 8, duration: '~4 jam (darat)', color: 'green' },
            { from: 8, to: 9, duration: '~49 jam', color: 'red' }
        ];
        legs.forEach((leg, index) => {
            const coords = [[points[leg.from].lat, points[leg.from].lng], [points[leg.to].lat, points[leg.to].lng]];
            L.polyline(coords, { color: leg.color, weight: 4, opacity: 0.8 }).addTo(map)
              .bindPopup(`<b>Leg ${index + 1}</b><br>${points[leg.from].name} ‚Üí ${points[leg.to].name}<br>Waktu Tempuh: ${leg.duration}`);
        });

        const shipIcon = L.divIcon({ className: 'ship-icon', html: 'üö¢', iconSize: [30, 30], iconAnchor: [15, 15] });
        const animationBtn = document.getElementById('animationBtn');

        let shipMarker = null;
        let animationInterval = null;
        let isAnimating = false;
        
        let currentLeg = 0;
        let progress = 0;

        function resetAnimation() {
            if (shipMarker) {
                shipMarker.remove();
                shipMarker = null;
            }
            currentLeg = 0;
            progress = 0;
            isAnimating = false;
            animationBtn.innerHTML = 'üö¢ Mulai Animasi Gerakan Kapal';
        }

        function toggleAnimation() {
            if (currentLeg >= legs.length) {
                resetAnimation();
            }
            
            if (isAnimating) {
                clearInterval(animationInterval);
                animationBtn.innerHTML = '‚ñ∂Ô∏è Lanjut Animasi Kapal';
                isAnimating = false;
            } else {
                if (!shipMarker) {
                    shipMarker = L.marker([points[0].lat, points[0].lng], { icon: shipIcon }).addTo(map);
                    shipMarker.setPopupContent(`<b>Leg ${currentLeg + 1}</b><br>Menuju ${points[legs[currentLeg].to].name}`).openPopup();
                }
                
                animationBtn.innerHTML = '‚è∏Ô∏è Jeda Animasi Kapal';
                isAnimating = true;
                
                map.panTo(shipMarker.getLatLng(), { animate: true, duration: 0.5 });
                
                animationInterval = setInterval(() => {
                    if (currentLeg >= legs.length) {
                        clearInterval(animationInterval);
                        shipMarker.setPopupContent('<b>Selesai!</b><br>Perjalanan berakhir.').openPopup();
                        animationBtn.innerHTML = 'üîÅ Ulangi Animasi';
                        isAnimating = false;
                        return;
                    }

                    const leg = legs[currentLeg];
                    const start = [points[leg.from].lat, points[leg.from].lng];
                    const end = [points[leg.to].lat, points[leg.to].lng];

                    const lat = start[0] + (end[0] - start[0]) * progress;
                    const lng = start[1] + (end[1] - start[1]) * progress;

                    shipMarker.setLatLng([lat, lng]);
                    map.panTo([lat, lng], { animate: true, duration: 0.05 });

                    progress += 0.01;
                    
                    if (progress >= 1) {
                        progress = 0;
                        currentLeg++;
                        if (currentLeg < legs.length) {
                            shipMarker.setPopupContent(`<b>Leg ${currentLeg + 1}</b><br>Menuju ${points[legs[currentLeg].to].name}`).openPopup();
                        }
                    }
                }, 50);
            }
        }

        const allCoords = points.map(p => [p.lat, p.lng]);
        map.fitBounds(L.latLngBounds(allCoords));
        map.touchZoom.enable();
    </script>
</body>
</html>
